import{u as d,j as i}from"./iframe-B_KIhOQz.js";import{o as l,b as m,g as S,i as u,c as b,d as j,N as a}from"./story-channel-hooks-NSiQDW4j.js";function k(e){return!!(Array.isArray(e.template.answerOption)&&e.template.answerOption.length>0||e.expressionRegistry.answer||e.template.answerValueSet)}function C(e){return e==="radio-button"||e==="check-box"||e==="drop-down"||e==="autocomplete"||e==="lookup"}function p(e){return m(e,"control")}function h(e){return u(e)?e.isRepeatingWithoutChildren&&(k(e)||e.type==="boolean"&&C(e.control)):!1}function w(e){if(!u(e))return;if(h(e))return m(e.token,"multi-select");const r=e.answers.at(0);return r?p(r.token):void 0}function g(e){return b(e)||j(e)?e.nodes:u(e)?(e.repeats?e.answers:e.answers.slice(0,1)).flatMap(t=>t.nodes):[]}function y(e){if(e.hidden)return;if(u(e))return w(e);const r=g(e);for(const t of r){const s=y(t);if(s)return s}}function T(e){const r=new Set,t=[];for(const s of e){const n=`${s.href??""}::${s.message}`;r.has(n)||(r.add(n),t.push(s))}return t}function c(e,r){return e.filter(t=>t.severity==="error"||t.severity==="fatal").map(t=>S(t)).filter(t=>t!==void 0).map(t=>({message:t,href:r}))}function f(e){if(e.hidden)return[];const r=[],t=y(e),s=t?`#${t}`:void 0;if(r.push(...c(e.issues,s)),u(e)){const n=e.repeats?e.answers:e.answers.slice(0,1),N=(()=>{const o=w(e);return o?`#${o}`:void 0})(),F=h(e);for(const o of n){const v=F?N:`#${p(o.token)}`;r.push(...c(o.issues,v));for(const x of o.nodes)r.push(...f(x))}return r}for(const n of g(e))r.push(...f(n));return r}function q(e){const r=[...e.headerNodes,...e.contentNodes,...e.footerNodes];return T([...c(e.issues),...r.flatMap(t=>f(t))])}const I=l(function({store:r}){const{ErrorSummary:t}=d(),s=q(r);if(s.length!==0)return i.jsx(t,{id:m("form","error-summary"),title:"There is a problem",items:s})});I.__docgenInfo={description:"",methods:[],displayName:"FormErrors",props:{store:{required:!0,tsType:{name:"IForm"},description:""}}};const E=l(function({store:r,onSubmit:t}){const{Form:s}=d(),n=r.isSubmitAttempted||r.issues.length>0?i.jsx(I,{store:r}):void 0;return i.jsx(s,{title:r.questionnaire.title,description:r.questionnaire.description,errors:n,before:i.jsx(a,{nodes:r.headerNodes}),after:i.jsx(a,{nodes:r.footerNodes}),onSubmit:t,onCancel:()=>r.reset(),pagination:r.pagination,children:i.jsx(a,{nodes:r.contentNodes})})});E.__docgenInfo={description:"",methods:[],displayName:"Form",props:{store:{required:!0,tsType:{name:"IForm"},description:""},onSubmit:{required:!1,tsType:{name:"union",raw:"(() => void) | undefined",elements:[{name:"unknown"},{name:"undefined"}]},description:""}}};export{E as F};
